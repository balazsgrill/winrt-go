// Code generated by winrt-go-gen. DO NOT EDIT.

//go:build windows

//nolint:all
package storage

import (
	"syscall"
	"unsafe"

	"github.com/go-ole/go-ole"
)

const GUIDIStorageItemPropertiesWithProvider string = "861bf39b-6368-4dee-b40e-74684a5ce714"
const SignatureIStorageItemPropertiesWithProvider string = "{861bf39b-6368-4dee-b40e-74684a5ce714}"

type IStorageItemPropertiesWithProvider struct {
	ole.IInspectable
}

type IStorageItemPropertiesWithProviderVtbl struct {
	ole.IInspectableVtbl

	GetProvider uintptr
}

func (v *IStorageItemPropertiesWithProvider) VTable() *IStorageItemPropertiesWithProviderVtbl {
	return (*IStorageItemPropertiesWithProviderVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *IStorageItemPropertiesWithProvider) GetProvider() (*StorageProvider, error) {
	var out *StorageProvider
	hr, _, _ := syscall.SyscallN(
		v.VTable().GetProvider,
		uintptr(unsafe.Pointer(v)),    // this
		uintptr(unsafe.Pointer(&out)), // out StorageProvider
	)

	if hr != 0 {
		return nil, ole.NewError(hr)
	}

	return out, nil
}
